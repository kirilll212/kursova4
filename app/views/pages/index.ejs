<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Admin Panel</title>

	<!-- Global stylesheets -->
	<link href="https://fonts.googleapis.com/css?family=Roboto:400,300,100,500,700,900" rel="stylesheet"
		type="text/css">
	<link href="assets/css/icons/icomoon/styles.css" rel="stylesheet" type="text/css">
	<link href="assets/css/bootstrap.css" rel="stylesheet" type="text/css">
	<link href="assets/css/core.css" rel="stylesheet" type="text/css">
	<link href="assets/css/components.css" rel="stylesheet" type="text/css">
	<link href="assets/css/colors.css" rel="stylesheet" type="text/css">
	<!-- /global stylesheets -->

	<!-- Core JS files -->
	<script type="text/javascript" src="assets/js/plugins/loaders/pace.min.js"></script>
	<script type="text/javascript" src="assets/js/core/libraries/jquery.min.js"></script>
	<script type="text/javascript" src="assets/js/core/libraries/bootstrap.min.js"></script>
	<script type="text/javascript" src="assets/js/plugins/loaders/blockui.min.js"></script>
	<!-- /core JS files -->

	<!-- Theme JS files -->
	<script type="text/javascript" src="assets/js/plugins/visualization/d3/d3.min.js"></script>
	<script type="text/javascript" src="assets/js/plugins/visualization/d3/d3_tooltip.js"></script>
	<script type="text/javascript" src="assets/js/plugins/forms/styling/switchery.min.js"></script>
	<script type="text/javascript" src="assets/js/plugins/forms/styling/uniform.min.js"></script>
	<script type="text/javascript" src="assets/js/plugins/forms/selects/bootstrap_multiselect.js"></script>
	<script type="text/javascript" src="assets/js/plugins/ui/moment/moment.min.js"></script>
	<script type="text/javascript" src="assets/js/plugins/pickers/daterangepicker.js"></script>
	<script type="text/javascript" src="assets/js/plugins/ui/nicescroll.min.js"></script>

	<script type="text/javascript" src="assets/js/core/app.js"></script>
	<script type="text/javascript" src="assets/js/pages/dashboard.js"></script>
	<script type="text/javascript" src="assets/js/pages/layout_fixed_custom.js"></script>
	<!-- /theme JS files -->

</head>

<body class="navbar-top">

	<!-- Main navbar -->
	<div class="navbar navbar-default navbar-fixed-top header-highlight">
		<div class="navbar-header">
			<a class="navbar-brand" href="index.html"><img src="assets/images/logo_light.png" alt=""></a>

			<ul class="nav navbar-nav visible-xs-block">
				<li><a data-toggle="collapse" data-target="#navbar-mobile"><i class="icon-tree5"></i></a></li>
				<li><a class="sidebar-mobile-main-toggle"><i class="icon-paragraph-justify3"></i></a></li>
			</ul>
		</div>

		<div class="navbar-collapse collapse" id="navbar-mobile">
			<ul class="nav navbar-nav">
				<li><a class="sidebar-control sidebar-main-toggle hidden-xs"><i class="icon-paragraph-justify3"></i></a>
				</li>
			</ul>

			<ul class="nav navbar-nav navbar-right">
				<li class="dropdown dropdown-user">
					<a class="dropdown-toggle" data-toggle="dropdown">
						<img src="assets/images/placeholder.jpg" alt="">
						<span>Kiril</span>
						<i class="caret"></i>
					</a>

					<ul class="dropdown-menu dropdown-menu-right">
						<li><a href="#"><i class="icon-switch2"></i> Logout</a></li>
					</ul>
				</li>
			</ul>
		</div>
	</div>
	<!-- /main navbar -->

	<!-- Page container -->
	<div class="page-container">

		<!-- Page content -->
		<div class="page-content">

			<!-- Main sidebar -->
			<div class="sidebar sidebar-main sidebar-fixed">
				<div class="sidebar-content">

					<!-- User menu -->
					<div class="sidebar-user">
						<div class="category-content">
							<div class="media">
								<a href="#" class="media-left"><img src="assets/images/placeholder.jpg"
										class="img-circle img-sm" alt=""></a>
								<div class="media-body">
									<span class="media-heading text-semibold">Kiril Kushnir</span>
									<div class="text-size-mini text-muted">
										<i class="icon-pin text-size-small"></i> &nbsp;Khmelnitsky, Ukraine
									</div>
								</div>

								<div class="media-right media-middle">
									<ul class="icons-list">
										<li>
											<a href="#"><i class="icon-cog3"></i></a>
										</li>
									</ul>
								</div>
							</div>
						</div>
					</div>
					<!-- /user menu -->


					<!-- Main navigation -->
					<div class="sidebar-category sidebar-category-visible">
						<div class="category-content no-padding">
							<ul class="navigation navigation-main navigation-accordion">

								<!-- Main -->
								<li class="navigation-header"><span>Main</span> <i class="icon-menu"
										title="Main pages"></i></li>
								<li><a href="/admin"><i class="icon-home4"></i> <span>Dashboard</span></a>
								</li>
								<li><a href="/admin/users"><i class="icon-users"></i> <span>Users</span></a></li>
								<li><a href="/admin/cars"><i class="icon-car"></i> <span>Cars</span></a></li>
								<li><a href="/admin/requests"><i class="icon-list"></i> <span>Requests</span></a></li>
								<!-- /main -->

							</ul>
						</div>
					</div>
					<!-- /main navigation -->

				</div>
			</div>
			<!-- /main sidebar -->

			<!-- Main content -->
			<div class="content-wrapper">

				<!-- Content area -->
				<div class="content">

					<!-- Dashboard content -->
					<div class="row">
						<div class="col-md-12">
							<div class="panel panel-flat">
								<div class="panel-heading">
									<h5 class="panel-title">Admin Panel for Managing Volunteer App</h5>
								</div>

								<div class="panel-body">
									Welcome to the admin panel where you can manage users, cars, and requests
									efficiently.
								</div>
							</div>
						</div>
					</div>
					<!-- /dashboard content -->

					<!-- Statistics -->
					<div class="row">
						<div class="col-lg-4">
							<div class="panel panel-body text-center">
								<i class="icon-users icon-3x text-teal-400"></i>
								<h3 class="no-margin" id="users"><%= usersCount %></h3>
								<span class="text-uppercase text-size-mini">Total Users</span>
							</div>
						</div>

						<div class="col-lg-4">
							<div class="panel panel-body text-center">
								<i class="icon-car icon-3x text-pink-400"></i>
								<h3 class="no-margin" id="cars"><%= carsCount %></h3>
								<span class="text-uppercase text-size-mini">Active Cars</span>
							</div>
						</div>

						<div class="col-lg-4">
							<div class="panel panel-body text-center">
								<i class="icon-list icon-3x text-indigo-400"></i>
								<h3 class="no-margin" id="requests"><%= requestsCount %></h3>
								<span class="text-uppercase text-size-mini">Pending Requests</span>
							</div>
						</div>
					</div>
					<!-- /Statistics -->

					<!-- Circle Chart -->
					<div class="row">
						<div class="col-md-4">
							<div class="panel panel-flat">
								<div class="panel-heading">
									<h5 class="panel-title">Circle Chart</h5>
								</div>

								<div class="panel-body text-center">
									<canvas id="Chart" width="200" height="200"></canvas>
								</div>
							</div>
						</div>
					</div>
					<!-- /Circle Chart -->

					<!-- Footer -->
					<div class="footer text-muted">
						&copy; 2023. <a href="#">Admin Panel</a> by <a href="#" target="_blank">Kiril Kushnir</a>
					</div>
					<!-- /footer -->

				</div>
				<!-- /content area -->

			</div>
			<!-- /main content -->

		</div>
		<!-- /page content -->

	</div>
	<!-- /page container -->
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	<script>
		var ctx = document.getElementById("Chart").getContext('2d');
		var myChart = new Chart(ctx, {
			type: 'doughnut',
			data: {
				labels: ["Users", "Cars", "Requests"],
				datasets: [{
					data: [],
					backgroundColor: ["#1ca6a4", "#ec4079", "#5c6bc0"]
				}]
			},
			options: {
				cutoutPercentage: 100,
				legend: {
					display: false
				}
			}
		});
		document.addEventListener('DOMContentLoaded', async function () {
        const response = await fetch('/admin/count');
        const data = await response.json();

        myChart.data.datasets[0].data = data;

        myChart.update();

        document.getElementById('users').innerText = data[1];
        document.getElementById('cars').innerText = data[0];
        document.getElementById('requests').innerText = data[2];
    });
	</script>

</body>

</html>